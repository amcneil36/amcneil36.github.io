<html> 
<script type = "text/javascript">
   var str0 = "<head><title> NxN Linear Solver </title></head><body><h3> NxN Linear Solver </h3><form id = \"addForm\"  action = \"\" method = \"post\"><table border = \"0\">";
   document.write(str0);
      document.write("<tr style = \"position:absolute; left:400px; top: 20px;\"><td>  Enter number of dimensions: <input type = \"text\" name = \"rowVal\" value = \"1\" size = \"1\" /> </td> </tr><tr style = \"position:absolute; left:630px; top: 20px;\"><td><input type = \"button\" name = \"addRows\" value = \"Generate Dimensions\" />  </td></tr>");
   for (var i = 0; i < 10; i++){
   document.write("<tr>");
   for (var j = 0; j < 11; j++){
   var str1 = "<td id = ";
   var str2 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat("+").concat(String("\"")).concat (">");
   var str3 = "a".concat("<sub>").concat((i+1).toString()).concat(",").concat((j+1).toString()).concat("</sub>").concat(": </td><td>");
   var str4 = "<input type = \"text\" id = ";
   var str5 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\""));
   var str6 = " name = ";
   var str7 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\""));
   var str8 = " value = \"\" size = \"1\" /> </td>";
   document.write(str1);
   document.write(str2);
   document.write(str3);
   document.write(str4);
   document.write(str5);
   document.write(str6);
   document.write(str7);
   document.write(str8);
   }
   document.write("</tr>");}
  
   document.write("<tr><td style = \"position:absolute; top:22px; left: 780px;\"><input type = \"button\" name = \"compute\" value = \"Calculate Solutions\" />  <input type = \"reset\" value = \"Clear\" /> </td></tr>");
   document.write("<tr style = \"position:absolute;\"><td>Solutions in fractional form (if applicable):  <input type = \"text\" name = \"sols\" id = \"sols\" size = \"120\" </td></tr>");

   document.write("</table></form></body>");
</script>
<script>

for (var i = 1; i < 10; i++){
for (var j = 0; j < 11; j++){
var temp = "a".concat(i.toString()).concat(",").concat(j.toString());
document.getElementById(temp).style.display = 'none';
var temp = temp.concat("+");
document.getElementById(temp).style.display = 'none';}}

for (var j = 2; j < 11; j++){
 var temp = "a0,".concat(j.toString());
 document.getElementById(temp).style.display = 'none';
 var temp = temp.concat("+");
 document.getElementById(temp).style.display = 'none';}




function simplestForm(fraction){
var num = getNumerator(fraction);
if (num == 0){return String(0);}
var den = getDenominator(fraction); 
var greatestCommonDivisor = GCD(num, den);
var num = num/greatestCommonDivisor;
var den = den/greatestCommonDivisor;
if (Math.abs(den) == 1){return String(num/den);}
if (Math.abs(num)==Math.abs(den)){ return String(num/den);}
if ((num>0 && den<0) || (num<0 && den<0)){ return String(num*-1).concat("/").concat(String(den*-1));}
return String(num).concat("/").concat(String(den));}

function divideFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2; 
var den = den1*num2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function multiplyFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*num2; 
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}


function addFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2+num2*den1;
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function subtractFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2-num2*den1;
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function getNumerator(fraction){
 var fraction = String(fraction);
 if (fraction.indexOf("/") == -1){return parseFloat(fraction);}
return parseFloat(fraction.substring(0, fraction.indexOf("/")));}

  function getDenominator(fraction){
 var fraction = String(fraction);
 if (fraction.indexOf("/") == -1){return 1;}
return parseFloat(fraction.substring(fraction.indexOf("/")+1, fraction.length));}

function GCD(x, y){ 
   if (x > y){
    var a = x;
    var b = y;}
   else{
   var a = y;
   var b = x; }  
   var q = Math.floor(a/b);
   var r = a%b;
   while (r!=0){
   var a = b;
   var b = r;
   var q = Math.floor(a/b);
   var r = a%b;}
   return Math.abs(b);} 





function backSolveAnswer(a){
var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
if (rows == 1){
 var stri = "x1 = ".concat(a[0][1])
 elt.sols.value = stri;
return;}
var answers = new Array();
answers.push(a[rows-1][rows]);
var k = rows-1;
for (var j = rows; j > 1; j--){
var val = a[j-2][rows];
var counter = 0;
for (var i = rows-1; i >= k; i--){
 val = subtractFractions(val, multiplyFractions(a[j-2][i], answers[counter])); 
 counter += 1;}
answers.push(val);
k-=1;
}

var stri = "";
var k = rows-1;
for (i = 0; i < rows-1; i++){
var stri = stri.concat("x").concat((i+1).toString()).concat(" = ").concat(answers[k].toString()).concat(", ");
k-=1;}
var stri = stri.concat("x").concat((rows).toString()).concat(" = ").concat(answers[0].toString());
elt.sols.value = stri;}

function solveDim(a){
var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
for (var i = 0; i < rows; i++){
a = solveCol(a, i);}
backSolveAnswer(a);}

function solveCol(a, col){
var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);

a = checkPivot(a, col);
a = divRow(a, col, a[col][col]); 
if (col == rows-1){
 return a;}
for (var i = col+1; i < rows; i++){
 a = zeroEntry(a, i, col);}	
return a;}

 function divRow(a, row, piv){ // divide row by pivot
  var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);

for (i = 0; i <= inp; i++){
	a[row][i] = divideFractions(a[row][i],piv);}
return a;}

function zeroEntry(a, row, col){ // zero out the necessary column entry, adjust the rest of the row
var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);	
var ze = a[row][col];
 for (i = 0; i <=inp; i++){
  a[row][i] = subtractFractions(a[row][i], multiplyFractions(ze,a[col][i]));}
 return a;}

function checkPivot(a, col){
 var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);

if (parseFloat(a[col][col]) != 0){
	return a;}
if (col+1 == inp){
	return a;}
for (var i = col+1; i <= inp; i++){
  if (parseFloat(a[i][col]) != 0){	  
  var a = rowSwap(a, col, i); 
  return a;}}
} // done with check Pivot

function rowSwap(a, row1, row2){
var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);
for (i = 0; i <= inp; i++){
 var temp = a[row1][i];
 a[row1][i] = a[row2][i];
 a[row2][i] = temp;}
 return a;}

document.getElementById("addForm").addRows.onclick = addRows;
function addRows(){
var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);
for (var i = 0; i < 10; i++){
 for (var j = 0; j < 11; j++){
 var temp = "a".concat(i.toString()).concat(",").concat(j.toString());
 if (i < inp && j < inp+1){
document.getElementById(temp).style.display = '';
var temp = temp.concat("+");
document.getElementById(temp).style.display = '';}
 else{
 document.getElementById(temp).style.display = 'none';
var temp = temp.concat("+");
document.getElementById(temp).style.display = 'none';}
}}
} // done with addRows

document.getElementById("addForm").compute.onclick = main;

function main(){
var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
var cols = rows+1;
var a = new Array();
for (var i = 0; i < rows; i++){
 var rowValues = new Array();
 for (var j = 0; j < rows+1; j++){
  var idx = "a".concat((i).toString()).concat(",").concat((j).toString());
  rowValues.push(document.getElementById(idx).value);}
 a.push(rowValues);} 
solveDim(a);} // done with main

</script>
</html>
