<html> 
<script type = "text/javascript">
   var str0 = "<head><title> NxN Linear Solver </title></head><body><h3> NxN Linear Solver </h3><form id = \"addForm\"  action = \"\" method = \"post\"><table border = \"0\">";
   document.write(str0);
      document.write("<tr style = \"position:absolute; left:400px; top: 20px;\"><td>  Enter number of dimensions: <input type = \"text\" name = \"rowVal\" value = \"1\" size = \"1\" /> </td> </tr><tr style = \"position:absolute; left:630px; top: 20px;\"><td><input type = \"button\" name = \"addRows\" value = \"Generate Dimensions\" />  </td></tr>");
   for (var i = 0; i < 10; i++){
   document.write("<tr>");
   for (var j = 0; j < 11; j++){
   var str1 = "<td id = ";
   var str2 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat("+").concat(String("\"")).concat (">");
   if (j < 9){var str3 = "x".concat("<sub>").concat((j+1).toString()).concat("</sub>").concat("  </td>");}
   if (j == 9){var str3 = "x".concat("<sub>").concat((j+1).toString()).concat("</sub>").concat("</td>");}
   if (j == 10){var str3 = "d".concat("<sub>").concat((i+1).toString()).concat("</sub>").concat(" </td>");}
   var str4 = "<td id = ";

   var str5 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\"")).concat("> + &nbsp;");
   if (j == 0){var str5 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\"")).concat(">")};
   if (j == 10){var str5 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\"")).concat("> &nbsp; = &nbsp;")};
   var str6 = "<input type = \"text\" id = ";
  var str7 = String("\"").concat("a").concat(i.toString()).concat(",,").concat(j.toString()).concat(String("\""));
   var str8 = " name = ";
   var str9 = String("\"").concat("a").concat(i.toString()).concat(",").concat(j.toString()).concat(String("\""));
   var str10 = " value = \"\" size = \"1\" /> </td>";
   document.write(str4);
   document.write(str5);
   document.write(str6);
   document.write(str7);
   document.write(str8);
   document.write(str9);
   document.write(str10);
      document.write(str1);
   document.write(str2);
   document.write(str3);
   }
   document.write("</tr>");}
  
   document.write("<tr><td style = \"position:absolute; top:22px; left: 780px;\"><input type = \"button\" name = \"compute\" value = \"Calculate Solutions\" />  <input type = \"reset\" value = \"Clear\" /> </td></tr>");
   document.write("<tr style = \"position:absolute;\"><td>Solutions in fractional form (if applicable):  <input type = \"text\" name = \"sols\" id = \"sols\" size = \"120\" </td></tr>");

   document.write("</table></form></body>");
</script>
<script>

for (var i = 1; i < 10; i++){
for (var j = 0; j < 11; j++){
var temp = "a".concat(i.toString()).concat(",").concat(j.toString());
document.getElementById(temp).style.display = 'none';
var temp = temp.concat("+");
document.getElementById(temp).style.display = 'none';}}

for (var j = 1; j < 10; j++){
 var temp = "a0,".concat(j.toString());
 document.getElementById(temp).style.display = 'none';
 var temp = temp.concat("+");
 document.getElementById(temp).style.display = 'none';}

 


function simplestForm(fraction){
var num = getNumerator(fraction);
if (num == 0){return String(0);}
var den = getDenominator(fraction); 
var greatestCommonDivisor = GCD(num, den);
var num = num/greatestCommonDivisor;
var den = den/greatestCommonDivisor;
if (Math.abs(den) == 1){return String(num/den);}
if (Math.abs(num)==Math.abs(den)){ return String(num/den);}
if ((num>0 && den<0) || (num<0 && den<0)){ return String(num*-1).concat("/").concat(String(den*-1));}
return String(num).concat("/").concat(String(den));}

function divideFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2; 
var den = den1*num2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function multiplyFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*num2; 
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}


function addFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2+num2*den1;
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function subtractFractions(fraction1, fraction2){
var num1 = getNumerator(fraction1);
var den1 = getDenominator(fraction1); 
var num2 = getNumerator(fraction2);
var den2 = getDenominator(fraction2);
var num = num1*den2-num2*den1;
var den = den1*den2;
return simplestForm(String(num).concat("/").concat(String(den)));}

function getNumerator(fraction){
 var fraction = String(fraction);
 if (fraction.indexOf("/") == -1){return parseFloat(fraction);}
return parseFloat(fraction.substring(0, fraction.indexOf("/")));}

  function getDenominator(fraction){
 var fraction = String(fraction);
 if (fraction.indexOf("/") == -1){return 1;}
return parseFloat(fraction.substring(fraction.indexOf("/")+1, fraction.length));}

function GCD(x, y){ 
   if (x > y){
    var a = x;
    var b = y;}
   else{
   var a = y;
   var b = x; }  
   var q = Math.floor(a/b);
   var r = a%b;
   while (r!=0){
   var a = b;
   var b = r;
   var q = Math.floor(a/b);
   var r = a%b;}
   return Math.abs(b);} 


   function copyMatrix(a){
	   var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
	   var b = new Array();
	   for (var i = 0; i < rows; i++){
	    var c = new Array();
	    for (var j = 0; j < rows+1; j++){
	     c.push(a[i][j]);}
	    b.push(c);}
	   return b;}
	   
function stringOfMatrixValue(val){
           if (getDenominator(val) && getNumerator(val) == 1){return "";}
	   if (getDenominator(val) == 1){return String(getNumerator(val));}
	   return "(".concat(val).concat(")");}



function stringOfMatrix2(a){

var elt = document.getElementById("addForm");
var rows = parseFloat(a.length);
var dim = parseFloat(elt.rowVal.value);

var strOfMatrix = "";
for (var i = 0; i < rows; i++){
 for (var j = 0; j < rows+1; j++){
         if (getNumerator(a[i][j])==0 && j != rows){continue;}
	 if (j == 0 && getNumerator(a[i][j])!=0){strOfMatrix = strOfMatrix.concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((1+dim-rows).toString()).concat(")");}
	 if (j > 0 && j < rows){
	 if(getNumerator(a[i][j-1])!=0){strOfMatrix = strOfMatrix.concat(" + ").concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1+dim-rows).toString()).concat(")");}
	 else{		 
	if (getNumerator(a[i][0])!=0){strOfMatrix = strOfMatrix.concat(" + ").concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1+dim-rows).toString()).concat(")");}
			else{strOfMatrix = strOfMatrix.concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1+dim-rows).toString()).concat(")");}}}
	 if (j == rows){strOfMatrix = strOfMatrix.concat(" = ").concat(a[i][j]);}}
strOfMatrix = strOfMatrix.concat('\n');}
return strOfMatrix;}


function stringOfMatrix(a){

var elt = document.getElementById("addForm");
var rows = parseFloat(a.length);
var strOfMatrix = "";
for (var i = 0; i < rows; i++){
 for (var j = 0; j < rows+1; j++){
         if (getNumerator(a[i][j])==0){continue;}
	 if (j == 0 && getNumerator(a[i][j])!=0){strOfMatrix = strOfMatrix.concat(stringOfMatrixValue(a[i][j])).concat("(x1)");}
	 if (j > 0 && j < rows){
	 if(getNumerator(a[i][j-1])!=0){strOfMatrix = strOfMatrix.concat(" + ").concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1).toString()).concat(")");}
	 else{		 
	if (getNumerator(a[i][0])!=0){strOfMatrix = strOfMatrix.concat(" + ").concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1).toString()).concat(")");}
			else{strOfMatrix = strOfMatrix.concat(stringOfMatrixValue(a[i][j])).concat("(x").concat((j+1).toString()).concat(")");}}}
	 if (j == rows){strOfMatrix = strOfMatrix.concat(" = ").concat(a[i][j]);}}
strOfMatrix = strOfMatrix.concat('\n');}
return strOfMatrix;}  	   


function checkPivot(a){
 var elt = document.getElementById("addForm");
var inp = a.length;
var dim = parseFloat(elt.rowVal.value);

if (getNumerator(a[0][0]) != 0){
	return a;}
if (1 == inp){
	return a;}
for (var i = 1; i <= inp; i++){
  if (parseFloat(a[i][0]) != 0){
  var b = copyMatrix(a);	  
  var a = rowSwap(a, 0, i);
  alert("Found a 0 in (x".concat((1+dim-inp).toString()).concat(") of equation 1. Swapping equations 1 and ").concat((i+1).toString()).concat(" of \n\n").concat(stringOfMatrix2(b)).concat("\nwill give us \n\n").concat(stringOfMatrix2(a))); 
  return a;}}
} // done with check Pivot

function rowSwap(a, row1, row2){
var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);
for (i = 0; i <= inp; i++){
 var temp = a[row1][i];
 a[row1][i] = a[row2][i];
 a[row2][i] = temp;}
 return a;}

document.getElementById("addForm").addRows.onclick = addRows;

function addRows(){
var elt = document.getElementById("addForm");
var inp = parseFloat(elt.rowVal.value);
for (var i = 0; i < 10; i++){
 for (var j = 0; j < 11; j++){
 var temp = "a".concat(i.toString()).concat(",").concat(j.toString());
 if (i < inp && j < inp){
document.getElementById(temp).style.display = '';
var temp = temp.concat("+");
document.getElementById(temp).style.display = '';}
 else{
 document.getElementById(temp).style.display = 'none';
var temp = temp.concat("+");
document.getElementById(temp).style.display = 'none';}
}}
for (var i = 0; i <inp; i++){
var temp = "a".concat(i.toString()).concat(",").concat("10");
document.getElementById(temp).style.display = '';
var temp = temp.concat("+");
document.getElementById(temp).style.display = '';
}
} // done with addRows

document.getElementById("addForm").compute.onclick = main;


	
 		  

function reduceMatrix(a){

var b = new Array();

for (var i = 0; i < a.length-1; i ++){
var rowValues = new Array(); 
for (var j = 0; j < a.length; j++){        
	if (j == a.length-1){	rowValues.push(subtractFractions(a[i+1][j+1], divideFractions(multiplyFractions(a[i+1][0], a[0][j+1]), a[0][0])));}
        else{rowValues.push(subtractFractions(a[i+1][j+1], divideFractions(multiplyFractions(a[i+1][0], a[0][j+1]), a[0][0])));}}
b.push(rowValues);}	
return b;
}


function computeSol(rowEq, solSet){
	 if(rowEq.length==2){
	 solSet.push(divideFractions(rowEq[1],rowEq[0]));
	return solSet;}
 val = rowEq[rowEq.length-1];
 var j = rowEq.length-2
 for (var i = 0; i < rowEq.length-2; i++){
 val = subtractFractions(val, multiplyFractions(rowEq[j],solSet[i]));
	 j--;} 
 val = divideFractions(val, rowEq[0]);
 solSet.push(val);
 return solSet;}

 function stringOfRow(a){
	 
	 var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
if (a.length == 2){
	var strVals = "x".concat((2+rows-a.length).toString()).concat(" = ").concat(divideFractions(a[1],a[0]));
	return strVals;}	
var strVals = "x".concat((2+rows-a.length).toString()).concat(" = ( ").concat(a[a.length-1]).concat(" - ");

for (var i = a.length-2; i >= 1; i--){
   	
       if (i == 1){strVals = strVals.concat(stringOfMatrixValue(a[i])).concat("(x").concat((i+2+rows-a.length).toString()).concat(") ");
       
       
       
       }	
       if (i > 1){strVals = strVals.concat(stringOfMatrixValue(a[i])).concat("(x").concat((i+2+rows-a.length).toString()).concat(") - ");	}
        ;}
strVals = strVals.concat(")")
if (getNumerator(a[0])!=1 && getDenominator(a[0])!=1){strVals = strVals.concat("/").concat(stringOfMatrixValue(a[0]));}
 return strVals;
 } 

function strOfSols(sols){
var strsols = ""
	var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
	for (var i = sols.length-2 ; i >= 0; i--){
         strsols = strsols.concat("x").concat((rows-i).toString()).concat(" = ").concat((sols[i]).toString()).concat("; ");
	}
return strsols;
}

function main(){
	var answers = new Array();
var equationset = new Array();
var elt = document.getElementById("addForm");
var rows = parseFloat(elt.rowVal.value);
var cols = rows+1;
var a = new Array();
var idx = "a".concat((0).toString()).concat(",,").concat((0).toString());
//if (document.getElementById(idx).value == ""){alert("Put in some values");return;}
for (var i = 0; i < rows; i++){
 var rowValues = new Array();
 for (var j = 0; j < rows; j++){
  var idx = "a".concat((i).toString()).concat(",,").concat((j).toString());
 //document.getElementById(idx).value = Math.floor((Math.random() * 9) + 1); 
  
  rowValues.push(document.getElementById(idx).value);}
 var idx = "a".concat((i).toString()).concat(",,").concat((10).toString());
 //document.getElementById(idx).value = Math.floor((Math.random() * 9) + 1); 
 rowValues.push(document.getElementById(idx).value);
 a.push(rowValues);}
alert("You entered: \n\n".concat(stringOfMatrix(a)));
if (a.length == 1){elt.sols.value = divideFractions(a[0][1],a[0][0]);return;}

a = checkPivot(a);
var b = new Array();
var reducedEquations = new Array();
var solSet = new Array();
reducedEquations.push(a[0]);
b = copyMatrix(a);
var c = new Array();
c = copyMatrix(b);

for (var i = 0; i < a.length-1; i++){
b = checkPivot(b);
b = reduceMatrix(b);
alert("Solving for (x".concat((rows+1-c.length).toString()).concat(") in equation 1 of \n\n").concat(stringOfMatrix2(c)).concat("\nGives us ").concat(stringOfRow(c[0])).concat("\n\nPlugging this value of x").concat((rows+1-c.length).toString()).concat(" into all of the x").concat((rows+1-c.length).toString()).concat("'s for all other equations and simplifying:\n\n").concat(stringOfMatrix2(b)));
//c = new Arary();
c = reduceMatrix(c);
reducedEquations.push(b[0]);}
for (var i = a.length-1; i >= 0; i--){
	solSet = computeSol(reducedEquations[i], solSet);
	if (i == a.length-1){alert("Using the equation\n\n".concat(stringOfRow(reducedEquations[i])).concat("\n\nImmediately gives us \n\n").concat(stringOfRow(reducedEquations[i])));}
	else{alert("Using the equation\n\n".concat(stringOfRow(reducedEquations[i])).concat("\n\nand ").concat(strOfSols(solSet)).concat("gives us \n\nx").concat((1+1+rows-reducedEquations[i].length).toString()).concat(" = ").concat(solSet[solSet.length-1]));}
	//alert(strOfSols(solSet));
}
var strsols = "";
var k = 1;
for (var i = solSet.length-1; i>0; i--){
	strsols = strsols.concat("x").concat((k).toString()).concat(" = ").concat(solSet[i]).concat(", ");
	k++;}
strsols = strsols.concat("x").concat((k).toString()).concat(" = ").concat(solSet[0]);	
elt.sols.value = (strsols);
} // done with main


</script>
</html>
