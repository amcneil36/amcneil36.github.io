

<html>
<head>
<title> Repeated Spending Calculator</title>
</head>
<body>
<h3> Repeated Spending Calculator Input </h3>
<h3 style = "position:absolute;left:670px;top:-10px;"> Repeated Spending Calculator Output</h3>

<form id = "addForm"  action = "" method = "post">
<table border = "0">
  <tr><td> Item name (optional): <input type = "text" name = "itemName" value = "" size = "20" /> </td> </tr>
  <tr><td> Cost of item ($): <input type = "text" name = "cost" value = "" size = "20" /> </td> </tr>

  <tr><td> Item is purchased every: <input type = "text" name = "timeVal" value = "" size = "1" />        
<select id = "timeUnits" name = "timeUnits">
<option selected = "selected"> Years </option>
<option value = "Months"> Months </option>
<option value = "Weeks"> Weeks </option>
<option value = "Days"> Days </option>
<option value = "Hours"> Hours </option>
<option value = "Minutes"> Minutes </option>
<option value = "Seconds"> Seconds </option>
</select></td></tr>

<tr><td> <input type = "radio" name = "rounding" value = "round" id = "round" size = "20" /> Round to 2 decimals <input type = "radio" name = "rounding" value = "dontround" id = "dontround" size = "20" /> Do not round</td> </tr>

  <tr>
  <td>
  <input type = "button" name = "addBtn" value = "Calculate" /> <input type = "reset" value = "Clear" /></td></tr>
<tr style = "position:absolute; top: 50px; left: 670px;"><td> Daily Spending ($): <input type = "text" name = "s1" value = "" size = "20" /> </td> </tr>
  <tr style = "position:absolute; top: 77px; left: 670px;"><td> Weekly Spending ($): <input type = "text" name = "s2" value = "" size = "20" /> </td> </tr>
  <tr style = "position:absolute; top: 104px; left: 670px;"><td> Monthly Spending ($): <input type = "text" name = "s3" value = "" size = "20" /> </td> </tr>
  <tr style = "position:absolute; top: 131px; left: 670px;"><td> Yearly Spending ($): <input type = "text" name = "s4" value = "" size = "20" /> </td> </tr>
</table>
</form>

<p style = "position:absolute; top: 400px; left: 10px;"> <textarea id = "response" rows = "8" cols = "116" name = "s5" value = "" /> </textarea> </p>
<p style = "position:absolute; top: 550px; left: 10px;"> <b>Microsoft Excel headings to copy/paste: </b><input type = "text" size = "80" name = "headers" value = "Item Name	Cost ($)	Bought Every	Units	Daily Cost	Weekly Cost	Monthly Cost	Yearly Cost" ></p>
<p style = "position:absolute; top: 350px; left: 10px;"> <b> Unsaved results to be copy pasted into Microsoft Excel and saved there: </b></p>


<p style = "position:absolute; top: 188px; left:10px;"> <b> Input Notes:</b> <br> (1) The item name is required if you want the result to be put in the box below <br> (2) Input the cost of the item <br> (3) Input the value for how frequently the item is purchased, then use the drop-down list to select the time units for that <br> (4) Select whether or not you want the result rounded <br> (5) Press "Calculate" to get your result<br> (6) Press "Clear" to wipe out the input and output or just adjust the input and pres "Calculate" again</p>


<p style = "position:absolute; top: 188px; left:870px;"> <b> Beginner instructions for how to save to Excel: </b> <br> (1) Navigate to the headings at the bottom textbox <br> (2) Left click in the headings textbox and press ctrl+a to highlight all the text <br> (3) With all of the text highlighted, press ctrl+c to copy it <br> (4) Open up Microsoft Excel and left click on cell A1 <br> (5) Press ctrl+v to paste the headings into the spreadsheet <br> (6) Come back to this page and navigate to the unsaved results text box <br> (7) Left click in the text area and press ctrl+a and ctrl+c to copy everthing <br> (8) Go back to Cell A2 on the excel spreadsheet and left click in it <br> (9) Press ctrl+v to paste your results into the spreadsheet <br> (10) Adjust the column widths as necessary to make everything fit <br> (11) Use functions to sum up the output columns however you want <br> (12) Save the spreadsheet to your computer and add to it when needed <br> (13) This program is for repeated spending and not for one time spending <br> (14) One time spending purposes must be taken into account seperately</p>


<script type = "text/javascript">

window.onbeforeunload = confirmExit;

  function confirmExit()
  {
    return "You have attempted to leave this page.  If you have not saved your output in the text area to Excel, your results will be lost.";
  }

document.getElementById("round").checked = true; 
document.getElementById("addForm").addBtn.onclick = main;
  function main()
  {
  
   
   var elt = document.getElementById("addForm"); 
  
   var cost = elt.cost.value;
   var timeVal = elt.timeVal.value;
   if (cost == '' || timeVal == ''){alert("Fill in the input");return;}
   if (isNaN(cost) || isNaN(timeVal)){alert("Cost or Time Val input is not a number");return;}
   if (!isNaN(elt.itemName.value)){alert("Input contain a letter");return;}  
   var timeUnits = elt.timeUnits.value;
 
   if (timeUnits == "Years"){
	   var rawValue = cost/timeVal;}
   if (timeUnits == "Months"){
	   var rawValue = 12*cost/timeVal;}
   if (timeUnits == "Weeks"){
	   var rawValue = (365/7)*cost/timeVal;}
   if (timeUnits == "Days"){
	   var rawValue = 365*cost/timeVal;}
   if (timeUnits == "Hours"){
	   var rawValue = 365*24*cost/timeVal;}
   if (timeUnits == "Minutes"){
	   var rawValue = 365*24*60*cost/timeVal;}
   if (timeUnits == "Seconds"){
	   var rawValue = 365*24*60*60*cost/timeVal;}

   if (document.getElementById("round").checked == true){
   elt.s4.value = rawValue.toFixed(2);
   elt.s3.value = (rawValue/12).toFixed(2);
   elt.s2.value = (rawValue/(365/7)).toFixed(2);
   elt.s1.value = (rawValue/365).toFixed(2);}

   else{
   elt.s4.value = rawValue;
   elt.s3.value = (rawValue/12);
   elt.s2.value = (rawValue/(365/7));
   elt.s1.value = (rawValue/365);}

   var outStr = '';
   if (elt.itemName.value != ''){
	   
	   if (document.getElementById("response").value.length > 3){
	     var outStr = document.getElementById("response").value;		
	   if (outStr.indexOf(elt.itemName.value) != -1){return;}	  
	     var outStr = outStr.concat("\n");}
	   var outStr = outStr.concat(elt.itemName.value.toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat(cost.toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat(timeVal.toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat(timeUnits.toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat((elt.s1.value).toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat((elt.s2.value).toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat((elt.s3.value).toString());
	   var outStr = outStr.concat("\t");
	   var outStr = outStr.concat((elt.s4.value).toString());
	   var outStr = outStr.concat("\t");  
  
	   
	   document.getElementById("response").value = outStr;
	   
   }


  }
</script>


</body>
</html>


